## 연관규칙분석  
  
연관규칙분석 : 주어진 어떤 집합에서 원소들 간에 존재하는 규칙을 찾는 것  
- 집합의 가능한 부분 집합을 모두 구해야 함  
- 원소의 수가 많으면 매우 많은 연산량 소모!  
빈발 항목 집합 : 부분 집합 중에서 빈번하게 나오는 아이템들의 집합  
=> Apriori(선험 규칙)으로 구함  
  
비빈발 항목 집합 : 부분 집합 중에서 빈번하게 나오지 않는 아이템들의 집합  
   
연관관계분석을 시각화한다.  
화살표가 있는 관계 데이터 => 방향성 그래프로 표현 가능함  
텍스트 마이닝, 소셜 네트워크 분석과 머징하여 사용하기도 함.  
  
ex)  
{TV, 프린터} -> {라면, 신사복}  
{TV, 프린터, 라면, 신사복}  
{은행, 카페} -> {보습학원}  
  
=> 점유율이 낮은 규칙은 아무 의미가 없음  
  
연관규칙분석의 개요  
[1] 변수 간의 흥미로운 관계를 발견하기 위한 규칙 기반 머신러닝 방법  
[2] POS(Point Of Sale) 시스템에서 제품 간의 규칙성을 발견하는 기법  
[3] 장바구니 분석, 생물 정보학, 웹 사용 마이닝 등에 활용    
   
## 연관규칙분석 알고리즘  
  
연관규칙의 표현 : X -> Y  
X = {구두, 운동화}  
y = {구두약, 운동화 세척제}  
=> 구두, 운동화가 존재할 때 구두약, 운동화 세척제가 존재한다!  
  
[사진 첨부 - 집합]  
n(X) = X를 만족하는 원소의 개수  
n(Y) = Y를 만족하는 원소의 개수  
n(AUB) = A와 B를 동시에 만족시키는 원소의 개수  
  
주의) n(AUB) = n(A사건 and B사건)   
  
s(X=>Y) = support(지지도) = n(XUY)/N = P(XUY)  
= 전체 건수 중에서 X와 U가 모두 포함되어있는 건수의 비  
c(X=>Y) = confidence(신뢰도) = n(XUY) / n(X) = P(Y|X)  
= 항목 X를 포함하는 건수 중 X와 Y를 모두 포함하는 건수의 비  
  
신뢰도 : 어떤 규칙이 어느정도 신뢰성이 있는지를 표현함  
서포트 : 전체 집합에서 어느 정도 점유율을 차지하는지를 나타냄  
  
비율에 관련한 정의)  
지지도 : 전체구매건수 중에서 상품 X와 상품 Y를 동시에 구매한 비율 (=> 확률)  
신뢰도 : 상품 X를 구매한 건 수 중에서 Y도 같이 구매한 비율 (=> 조건부확률)  
  
규칙을 만들 때는?  
최소 지지도를 먼저 결정함 => 신뢰도가 높은 규칙을 찾음 => 신뢰도를 높이면서 더 좋은 규칙을 찾아냄  
  
지지도와 신뢰만으로 어떤 규칙이 좋은 규칙인지 평가하기 부족하다.  
  
=> 향상도 사용!!  
  
향상도(Lift) : 그냥 B를 구매한 경우와, A를 구매한 후에 B를 구매한 경우의 차이가 클수록 큰 의미를 가짐  
Support = 상품 Y를 구매한 비율  
Confidence = X를 산 고객 중에서 상품 Y를 산 조건부 확률  
향상도 = 신뢰도 / P(Y)  
향상도는 상품 Y를 구매한 경우보다 얼마나 향상이 되었는지를 보는 것  
Lift(A, B) = c(A->B) / s(B)  
B 구매 경우, A 구매 -> B 구매의 경우의 차이가 클 수록 큰 의미를 가짐  
리프트(향상도)는 항상 절댓값이 1 이상인 것을 찾아야 함!!  
Lift => X를 샀을 때 Y를 살 확률 / Y를 살 확률 = P(Y|X) / P(Y) = P(XUY) / P(X)P(Y)  
= 신뢰도 / P(Y)  
* A, B는 서로 독립이라면?  
Lift 1이 되어 향상이 0이라는 의미가 됨  
Lift > 1 = 양의 상관  
Lift < 1 = 음의 상관  
A=>B : A와 B는 종속관계이다.  
리프트(향상도)는 절댓값이 1보다 클수록 좋은 것이 된다.  
  
연관탐사규칙을 만드는 절차  
(1) 최소지지도를 먼저 결정  
(2) 최소 지지도보다 높은 지지도 중에서 신뢰도가 높은 규칙을 찾는다.  
(3) 신뢰도를 차츰차츰 높이면서 더 좋은 규칙을 찾아낸다.  
  
선험 규칙 : 모든 경우의 규칙 패턴을 관찰하기 위해 필요한 연산 규칙  
  
빈발 항목 집합을 찾으려면? => 트랜잭션에서 개수를 세어야 함  
ex) 5개의 상품의 경우의 수 종류 31가지  
상품의 개수가 많아질수록 연산량이 매우 빠른 속도로 증가됨!!  
   
<img width="229" alt="선험" src="https://github.com/user-attachments/assets/0bfed417-1253-498c-917a-043dae15103a" />
<br>
  
천문학적인 연산 비용을 절약하기 위해선?  
=> 선험 규칙(Apriori)를 적용한다!  
  
- 선험 규칙  
[1] 한 항목 집합이 빈발하면 그 집합의 모든 부분 집합은 빈발 항목 집합이다.  
[2] 한 항목 집합이 비빈발이면 이 항목 집합을 포함하는 모든 집합은 비빈발 항목 집합이다.  
